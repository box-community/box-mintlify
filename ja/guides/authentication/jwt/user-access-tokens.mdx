---
alias_paths: {}
rank: 4
related_endpoints: {}
related_guides:
  0: authentication/jwt
  1: authentication/select
related_resources: {}
required_guides:
  0: authentication/oauth2/with-sdk
  1: authentication/oauth2/without-sdk
title: ユーザーアクセストークン

fullyTranslated: true
---

import {RelatedLinks, MultiRelatedLinks} from "/snippets/related-links.jsx";

<RelatedLinks
  title="必須のガイド"
  items={[
  { label: "OAuth 2.0 with SDKs", href: "/guides/authentication/oauth2/with-sdk", badge: "GUIDE" },
  { label: "OAuth 2.0 without SDKs", href: "/guides/authentication/oauth2/without-sdk", badge: "GUIDE" }
]}
/>

JWTアプリケーションは、[サービスアカウント][sa]ではなく特定のユーザーに対してアクセストークンを作成できます。

## 前提条件

アプリケーションは、ユーザーアクセストークンの作成を許可するように構成する必要があります。この設定は、[開発者コンソール][devconsole]の \[**構成**] タブにあります。

<Frame border center>
  ![高度な機能](./enable-user-access-tokens.png)
</Frame>

さらに、認証済みユーザーは、管理者権限を持つユーザー、つまり、管理者、共同管理者、サービスアカウントのいずれかである必要があります。詳細については、[ユーザータイプ](/platform/user-types)のガイドを参照してください。

## SDKを使用したユーザーアクセストークン

特定のユーザーとして認証するBox SDKクライアントを作成するには、[SDKを使用したJWTのガイド](/guides/authentication/jwt/with-sdk)で説明されている手順に従います。ただし、「Enterprise」クライアントではなく、ユーザークライアントを作成します。

<CodeGroup>
  ```csharp .Net
  var userId = "12345";
  var sdk = new BoxJWTAuth(config);
  var token = sdk.UserToken(appUserID);
  BoxClient client = sdk.UserClient(userToken, userId);
  ```

  ```java Java
  String userId = "12345";
  BoxDeveloperEditionAPIConnection api = new BoxDeveloperEditionAPIConnection.getAppUserConnection(userId, config)
  ```

  ```python Python
  user = client.user(user_id='12345')

  auth = JWTAuth(
      client_id='[CLIENT_ID]',
      client_secret='[CLIENT_SECRET]',
      user=app_user,
      jwt_key_id='[JWT_KEY_ID]',
      rsa_private_key_file_sys_path='[CERT.PEM]',
      rsa_private_key_passphrase='[PASSPHRASE]'
  )
  auth.authenticate_user()
  user_client = Client(auth)
  ```

  ```js Node
  var sdk = BoxSDK.getPreconfiguredInstance(config);
  var client = sdk.getAppAuthClient('user', '12345');
  ```
</CodeGroup>

<Card href="/guides/authentication/jwt/with-sdk" arrow title="Box SDKとJWTの使用の詳細を確認する" />

## SDKを使用しないユーザーアクセストークン

特定のユーザーとして認証するユーザーアクセストークンを作成するには、[SDKを使用しないJWTのガイド](/guides/authentication/jwt/without-sdk)で説明されている手順に従います。ただし、企業用のクレームを作成するのではなく、特定のユーザーID用のクレームを作成します。

<CodeGroup>
  ```csharp .Net
  var userId = "12345";

  var claims = new List<Claim>{
      new Claim("sub", userid),
      new Claim("box_sub_type", "user"),
      new Claim("jti", jti),
  };
  ```

  ```java Java
  String userId = "12345";

  JwtClaims claims = new JwtClaims();
  claims.setIssuer(config.boxAppSettings.clientID);
  claims.setAudience(authenticationUrl);
  claims.setSubject(userId);
  claims.setClaim("box_sub_type", "user");
  claims.setGeneratedJwtId(64);
  claims.setExpirationTimeMinutesInTheFuture(0.75f);
  ```

  ```python Python
  user_id = '12345'

  claims = {
      'iss': config['boxAppSettings']['clientID'],
      'sub': user_id,
      'box_sub_type': 'user',
      'aud': authentication_url,
      'jti': secrets.token_hex(64),
      'exp': round(time.time()) + 45
  }
  ```

  ```js Node
  let user_id = '12345';

  let claims = {
      iss: config.boxAppSettings.clientID,
      sub: user_id,
      box_sub_type: "user",
      aud: authenticationUrl,
      jti: crypto.randomBytes(64).toString("hex"),
      exp: Math.floor(Date.now() / 1000) + 45
  };
  ```

  ```ruby Ruby
  user_id = '12345'

  claims = {
    iss: config['boxAppSettings']['clientID'],
    sub: user_id,
    box_sub_type: 'user',
    aud: authentication_url,
    jti: SecureRandom.hex(64),
    exp: Time.now.to_i + 45
  }
  ```

  ```php PHP
  $userId = '12345';

  $claims = [
    'iss' => $config->boxAppSettings->clientID,
    'sub' => $userId,
    'box_sub_type' => 'user',
    'aud' => $authenticationUrl,
    'jti' => base64_encode(random_bytes(64)),
    'exp' => time() + 45,
    'kid' => $config->boxAppSettings->appAuth->publicKeyID
  ];
  ```
</CodeGroup>

<Card href="/guides/authentication/jwt/with-sdk" arrow title="手動によるJWT認証の使用の詳細を確認する" />

[devconsole]: https://app.box.com/developers/console

[sa]: /platform/user-types/#service-account

<RelatedLinks
  title="関連するガイド"
  items={[
  { label: "JWT Auth", href: "/guides/authentication/jwt/index", badge: "GUIDE" },
  { label: "Select Auth Method", href: "/guides/authentication/select", badge: "GUIDE" }
]}
/>
